/* Generated by wbuild from "ArtText.w"
** (generator version $Revision$ of $Date$)
*/
#if HAVE_CONFIG_H
#  include <config.h>
#endif
#include <X11/IntrinsicP.h>
#include <X11/StringDefs.h>
#line 173 "ArtText.w"
#include <assert.h>
#line 174 "ArtText.w"
#include <ctype.h>
#line 175 "ArtText.w"
#include <stdio.h>
#line 176 "ArtText.w"
#include <string.h>
#line 177 "ArtText.w"
#include <Xfwf/TextOut.h>
#include <Xfwf/ArtTextP.h>
static void _resolve_inheritance(
#if NeedFunctionPrototypes
WidgetClass
#endif
);
#line 33 "ArtText.w"
static void initialize(
#if NeedFunctionPrototypes
Widget ,Widget,ArgList ,Cardinal *
#endif
);
#line 45 "ArtText.w"
static Boolean  set_values(
#if NeedFunctionPrototypes
Widget ,Widget ,Widget,ArgList ,Cardinal *
#endif
);

static XtResource resources[] = {
#line 14 "ArtText.w"
{XtNbodyFont,XtCBodyFont,XtRFontStruct,sizeof(((XfwfArticleTextRec*)NULL)->xfwfArticleText.bodyFont),XtOffsetOf(XfwfArticleTextRec,xfwfArticleText.bodyFont),XtRString,(XtPointer)XtDefaultFont },
#line 15 "ArtText.w"
{XtNquoteFont,XtCQuoteFont,XtRFontStruct,sizeof(((XfwfArticleTextRec*)NULL)->xfwfArticleText.quoteFont),XtOffsetOf(XfwfArticleTextRec,xfwfArticleText.quoteFont),XtRString,(XtPointer)XtDefaultFont },
#line 16 "ArtText.w"
{XtNheaderItemFont,XtCHeaderItemFont,XtRFontStruct,sizeof(((XfwfArticleTextRec*)NULL)->xfwfArticleText.headerItemFont),XtOffsetOf(XfwfArticleTextRec,xfwfArticleText.headerItemFont),XtRString,(XtPointer)XtDefaultFont },
#line 17 "ArtText.w"
{XtNheaderValueFont,XtCHeaderValueFont,XtRFontStruct,sizeof(((XfwfArticleTextRec*)NULL)->xfwfArticleText.headerValueFont),XtOffsetOf(XfwfArticleTextRec,xfwfArticleText.headerValueFont),XtRString,(XtPointer)XtDefaultFont },
#line 21 "ArtText.w"
{XtNbodyColor,XtCBodyColor,XtRPixel,sizeof(((XfwfArticleTextRec*)NULL)->xfwfArticleText.bodyColor),XtOffsetOf(XfwfArticleTextRec,xfwfArticleText.bodyColor),XtRString,(XtPointer)XtDefaultForeground },
#line 22 "ArtText.w"
{XtNquoteColor,XtCQuoteColor,XtRPixel,sizeof(((XfwfArticleTextRec*)NULL)->xfwfArticleText.quoteColor),XtOffsetOf(XfwfArticleTextRec,xfwfArticleText.quoteColor),XtRString,(XtPointer)XtDefaultForeground },
#line 23 "ArtText.w"
{XtNheaderItemColor,XtCHeaderItemColor,XtRPixel,sizeof(((XfwfArticleTextRec*)NULL)->xfwfArticleText.headerItemColor),XtOffsetOf(XfwfArticleTextRec,xfwfArticleText.headerItemColor),XtRString,(XtPointer)XtDefaultForeground },
#line 24 "ArtText.w"
{XtNheaderValueColor,XtCHeaderValueColor,XtRPixel,sizeof(((XfwfArticleTextRec*)NULL)->xfwfArticleText.headerValueColor),XtOffsetOf(XfwfArticleTextRec,xfwfArticleText.headerValueColor),XtRString,(XtPointer)XtDefaultForeground },
#line 29 "ArtText.w"
{XtNquoteChar,XtCQuoteChar,XtRChar,sizeof(((XfwfArticleTextRec*)NULL)->xfwfArticleText.quoteChar),XtOffsetOf(XfwfArticleTextRec,xfwfArticleText.quoteChar),XtRImmediate,(XtPointer)'>'},
};

XfwfArticleTextClassRec xfwfArticleTextClassRec = {
{ /* core_class part */
/* superclass   	*/  (WidgetClass) &xfwfTextOutClassRec,
/* class_name   	*/  "XfwfArticleText",
/* widget_size  	*/  sizeof(XfwfArticleTextRec),
/* class_initialize 	*/  NULL,
/* class_part_initialize*/  _resolve_inheritance,
/* class_inited 	*/  FALSE,
/* initialize   	*/  initialize,
/* initialize_hook 	*/  NULL,
/* realize      	*/  XtInheritRealize,
/* actions      	*/  NULL,
/* num_actions  	*/  0,
/* resources    	*/  resources,
/* num_resources 	*/  9,
/* xrm_class    	*/  NULLQUARK,
/* compres_motion 	*/  True ,
/* compress_exposure 	*/  XtExposeCompressMultiple |XtExposeGraphicsExposeMerged ,
/* compress_enterleave 	*/  True ,
/* visible_interest 	*/  TRUE ,
/* destroy      	*/  NULL,
/* resize       	*/  XtInheritResize,
/* expose       	*/  XtInheritExpose,
/* set_values   	*/  set_values,
/* set_values_hook 	*/  NULL,
/* set_values_almost 	*/  XtInheritSetValuesAlmost,
/* get_values+hook 	*/  NULL,
/* accept_focus 	*/  XtInheritAcceptFocus,
/* version      	*/  XtVersion,
/* callback_private 	*/  NULL,
/* tm_table      	*/  NULL,
/* query_geometry 	*/  XtInheritQueryGeometry,
/* display_acceleator 	*/  XtInheritDisplayAccelerator,
/* extension    	*/  NULL 
},
{ /* composite_class part */
XtInheritGeometryManager,
XtInheritChangeManaged,
XtInheritInsertChild,
XtInheritDeleteChild,
NULL
},
{ /* XfwfCommon_class part */
XtInherit_compute_inside,
XtInherit_total_frame_width,
XtInherit_highlight_border,
XtInherit_unhighlight_border,
XtInherit_would_accept_focus,
XtInherit_traverse,
XtInherit_lighter_color,
XtInherit_darker_color,
/* traversal_trans */  NULL ,
},
{ /* XfwfTextOut_class part */
 /* dummy */  0
},
{ /* XfwfArticleText_class part */
 /* dummy */  0
},
};
WidgetClass xfwfArticleTextWidgetClass = (WidgetClass) &xfwfArticleTextClassRec;
static void _resolve_inheritance(class)
WidgetClass class;
{
  XfwfArticleTextWidgetClass c = (XfwfArticleTextWidgetClass) class;
  XfwfArticleTextWidgetClass super;
  static CompositeClassExtensionRec extension_rec = {
    NULL, NULLQUARK, XtCompositeExtensionVersion,
    sizeof(CompositeClassExtensionRec), True};
  CompositeClassExtensionRec *ext;
  ext = (XtPointer)XtMalloc(sizeof(*ext));
  *ext = extension_rec;
  ext->next_extension = c->composite_class.extension;
  c->composite_class.extension = ext;
  if (class == xfwfArticleTextWidgetClass) return;
  super = (XfwfArticleTextWidgetClass)class->core_class.superclass;
}
#line 33 "ArtText.w"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 33 "ArtText.w"
static void initialize(Widget  request,Widget self,ArgList  args,Cardinal * num_args)
#else
#line 33 "ArtText.w"
static void initialize(request,self,args,num_args)Widget  request;Widget self;ArgList  args;Cardinal * num_args;
#endif
#line 34 "ArtText.w"
{
	((XfwfArticleTextWidget)self)->xfwfTextOut.color1 = ((XfwfArticleTextWidget)self)->xfwfArticleText.bodyColor;
	((XfwfArticleTextWidget)self)->xfwfTextOut.color2 = ((XfwfArticleTextWidget)self)->xfwfArticleText.quoteColor;
	((XfwfArticleTextWidget)self)->xfwfTextOut.color3 = ((XfwfArticleTextWidget)self)->xfwfArticleText.headerItemColor;
	((XfwfArticleTextWidget)self)->xfwfTextOut.color4 = ((XfwfArticleTextWidget)self)->xfwfArticleText.headerValueColor;
	((XfwfArticleTextWidget)self)->xfwfTextOut.font1 = ((XfwfArticleTextWidget)self)->xfwfArticleText.bodyFont;
	((XfwfArticleTextWidget)self)->xfwfTextOut.font2 = ((XfwfArticleTextWidget)self)->xfwfArticleText.quoteFont;
	((XfwfArticleTextWidget)self)->xfwfTextOut.font3 = ((XfwfArticleTextWidget)self)->xfwfArticleText.headerItemFont;
	((XfwfArticleTextWidget)self)->xfwfTextOut.font4 = ((XfwfArticleTextWidget)self)->xfwfArticleText.headerValueFont;
}
#line 45 "ArtText.w"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 45 "ArtText.w"
static Boolean  set_values(Widget  old,Widget  request,Widget self,ArgList  args,Cardinal * num_args)
#else
#line 45 "ArtText.w"
static Boolean  set_values(old,request,self,args,num_args)Widget  old;Widget  request;Widget self;ArgList  args;Cardinal * num_args;
#endif
#line 46 "ArtText.w"
{
	int do_size = False;

	((XfwfArticleTextWidget)self)->xfwfTextOut.color1 = ((XfwfArticleTextWidget)self)->xfwfArticleText.bodyColor;
	((XfwfArticleTextWidget)self)->xfwfTextOut.color2 = ((XfwfArticleTextWidget)self)->xfwfArticleText.quoteColor;
	((XfwfArticleTextWidget)self)->xfwfTextOut.color3 = ((XfwfArticleTextWidget)self)->xfwfArticleText.headerItemColor;
	((XfwfArticleTextWidget)self)->xfwfTextOut.color4 = ((XfwfArticleTextWidget)self)->xfwfArticleText.headerValueColor;

	if(((XfwfArticleTextWidget)old)->xfwfArticleText.quoteChar != ((XfwfArticleTextWidget)self)->xfwfArticleText.quoteChar)
		do_size = True;

	if(((XfwfArticleTextWidget)old)->xfwfArticleText.bodyFont != ((XfwfArticleTextWidget)self)->xfwfArticleText.bodyFont)
	{
		((XfwfArticleTextWidget)self)->xfwfTextOut.font1 = ((XfwfArticleTextWidget)self)->xfwfArticleText.bodyFont;
		do_size = True;
	}
	
	if(((XfwfArticleTextWidget)old)->xfwfArticleText.quoteFont != ((XfwfArticleTextWidget)self)->xfwfArticleText.quoteFont)
	{
		((XfwfArticleTextWidget)self)->xfwfTextOut.font2 = ((XfwfArticleTextWidget)self)->xfwfArticleText.quoteFont;
		do_size = True;
	}
	
	if(((XfwfArticleTextWidget)old)->xfwfArticleText.headerItemFont != ((XfwfArticleTextWidget)self)->xfwfArticleText.headerItemFont)
	{
		((XfwfArticleTextWidget)self)->xfwfTextOut.font3 = ((XfwfArticleTextWidget)self)->xfwfArticleText.headerItemFont;
		do_size = True;
	}
	
	if(((XfwfArticleTextWidget)old)->xfwfArticleText.headerValueFont != ((XfwfArticleTextWidget)self)->xfwfArticleText.headerValueFont)
	{
		((XfwfArticleTextWidget)self)->xfwfTextOut.font4 = ((XfwfArticleTextWidget)self)->xfwfArticleText.headerValueFont;
		do_size = True;
	}
	
	if(do_size)
		XfwfComputeTextOutSize(self, &(((XfwfArticleTextWidget)self)->core.width), &(((XfwfArticleTextWidget)self)->core.height));

	return do_size;
}
#line 98 "ArtText.w"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 98 "ArtText.w"
void XfwfSetArticleText(Widget self,char * data)
#else
#line 98 "ArtText.w"
void XfwfSetArticleText(self,data)Widget self;char * data;
#endif
#line 99 "ArtText.w"
{
	char *header = data;
	char *ptr, t;
	char *body;
	
	assert(XtIsSubclass(self, xfwfArticleTextWidgetClass));

	XfwfEraseText(self);
	body = strstr(data, "\n\n");
	
	while(header < body)
	{
		if(header[0]!=' ' && (ptr = strchr(header, ':')) != NULL)
		{
			ptr+=2;
			t=*ptr;
			*ptr=0;
			XfwfAddText(self, header, 3, 3, 0);
			*ptr=t;
			header = strchr(header, '\n');
			if(header!=NULL)
			{
				t=*header;
				*header=0;
			}
			XfwfAddText(self, ptr, 4, 4, 1);
			if(header!=NULL)
			{
				*header=t;
				header++;
			}
			else
				header=body;
		}
		else
		{
			ptr = strchr(header, '\n');
			if(ptr!=NULL) *ptr=0;
			XfwfAddText(self, header, 4, 4, 1);
			if(ptr!=NULL)
			{
				header = ptr+1;
				*ptr='\n';
			}else{
				header=body;
			}
		}
	}
	
	XfwfAddText(self, "", 3, 1, 1);

	while(*body)
	{
		ptr=strchr(body, '\n');
		if(ptr!=NULL)
		{
			t=*ptr;
			*ptr=0;
		}
		if(*body == ((XfwfArticleTextWidget)self)->xfwfArticleText.quoteChar)
			XfwfAddText(self, body, 2, 2, 1);
		else
			XfwfAddText(self, body, 1, 1, 1);
		if(ptr==NULL)
			break;
		*ptr=t;
		body=ptr+1;
	}
	
	XfwfAddText(self, NULL, 0, 0, 0);
}
