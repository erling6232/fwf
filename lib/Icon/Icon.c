/* Generated by wbuild from "Icon.w"
** (generator version $Revision$ of $Date$)
*/
#if HAVE_CONFIG_H
#  include <config.h>
#endif

#include <X11/IntrinsicP.h>
#include <X11/StringDefs.h>
#line 193 "Icon.w"
#include <X11/extensions/shape.h>
#line 194 "Icon.w"
#include <stdio.h>
#include <Xfwf/IconP.h>
#line 161 "Icon.w"
static void activate(
#if NeedFunctionPrototypes
Widget,XEvent*,String*,Cardinal*
#endif
);

static XtActionsRec actionsList[] = {
{"activate", activate},
};

static char defaultTranslations[] = "\
<Btn1Down>,<Btn1Up>: activate() \n\
<Key>Return: activate() \n\
";
static void _resolve_inheritance(
#if NeedFunctionPrototypes
WidgetClass
#endif
);
#line 57 "Icon.w"
static void initialize(
#if NeedFunctionPrototypes
Widget ,Widget,ArgList ,Cardinal *
#endif
);
#line 85 "Icon.w"
static void expose(
#if NeedFunctionPrototypes
Widget,XEvent *,Region 
#endif
);
#line 101 "Icon.w"
static Boolean  set_values(
#if NeedFunctionPrototypes
Widget ,Widget ,Widget,ArgList ,Cardinal *
#endif
);
#line 136 "Icon.w"
static void realize(
#if NeedFunctionPrototypes
Widget,XtValueMask *,XSetWindowAttributes *
#endif
);
#line 172 "Icon.w"
static void create_image_gc(
#if NeedFunctionPrototypes
Widget
#endif
);
#line 172 "Icon.w"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 172 "Icon.w"
static void create_image_gc(Widget self)
#else
#line 172 "Icon.w"
static void create_image_gc(self)Widget self;
#endif
#line 173 "Icon.w"
{
    Dimension wd, ht;
    Position x, y;
    XtGCMask mask = GCFillStyle | GCTileStipXOrigin | GCTileStipYOrigin;
    XGCValues values;

    if (((XfwfIconWidget)self)->xfwfIcon.image_gc != NULL) XtReleaseGC(self, ((XfwfIconWidget)self)->xfwfIcon.image_gc);
    ((XfwfIconWidgetClass)self->core.widget_class)->xfwfCommon_class.compute_inside(self, &x, &y, &wd, &ht);
    if (((XfwfIconWidget)self)->xfwfIcon.image && ((XfwfIconWidget)self)->xfwfIcon.image->pixmap != None) {
	values.tile = ((XfwfIconWidget)self)->xfwfIcon.image->pixmap;
	mask |= GCTile;
    }
    values.fill_style = FillTiled;
    values.ts_x_origin = x;
    values.ts_y_origin = y;
    ((XfwfIconWidget)self)->xfwfIcon.image_gc = XtGetGC(self, mask, &values);
}

static XtResource resources[] = {
#line 28 "Icon.w"
{XtNimage,XtCImage,XtRIcon,sizeof(((XfwfIconRec*)NULL)->xfwfIcon.image),XtOffsetOf(XfwfIconRec,xfwfIcon.image),XtRImmediate,(XtPointer)NULL },
#line 33 "Icon.w"
{XtNactivate,XtCActivate,XtRCallback,sizeof(((XfwfIconRec*)NULL)->xfwfIcon.activate),XtOffsetOf(XfwfIconRec,xfwfIcon.activate),XtRImmediate,(XtPointer)NULL },
#line 37 "Icon.w"
{XtNframeWidth,XtCFrameWidth,XtRDimension,sizeof(((XfwfIconRec*)NULL)->xfwfFrame.frameWidth),XtOffsetOf(XfwfIconRec,xfwfFrame.frameWidth),XtRImmediate,(XtPointer)0 },
};

XfwfIconClassRec xfwfIconClassRec = {
{ /* core_class part */
/* superclass   	*/  (WidgetClass) &xfwfBoardClassRec,
/* class_name   	*/  "XfwfIcon",
/* widget_size  	*/  sizeof(XfwfIconRec),
/* class_initialize 	*/  NULL,
/* class_part_initialize*/  _resolve_inheritance,
/* class_inited 	*/  FALSE,
/* initialize   	*/  initialize,
/* initialize_hook 	*/  NULL,
/* realize      	*/  realize,
/* actions      	*/  actionsList,
/* num_actions  	*/  1,
/* resources    	*/  resources,
/* num_resources 	*/  3,
/* xrm_class    	*/  NULLQUARK,
/* compres_motion 	*/  True ,
/* compress_exposure 	*/  XtExposeCompressMultiple ,
/* compress_enterleave 	*/  True ,
/* visible_interest 	*/  TRUE ,
/* destroy      	*/  NULL,
/* resize       	*/  XtInheritResize,
/* expose       	*/  expose,
/* set_values   	*/  set_values,
/* set_values_hook 	*/  NULL,
/* set_values_almost 	*/  XtInheritSetValuesAlmost,
/* get_values+hook 	*/  NULL,
/* accept_focus 	*/  XtInheritAcceptFocus,
/* version      	*/  XtVersion,
/* callback_private 	*/  NULL,
/* tm_table      	*/  defaultTranslations,
/* query_geometry 	*/  XtInheritQueryGeometry,
/* display_acceleator 	*/  XtInheritDisplayAccelerator,
/* extension    	*/  NULL 
},
{ /* composite_class part */
XtInheritGeometryManager,
XtInheritChangeManaged,
XtInheritInsertChild,
XtInheritDeleteChild,
NULL
},
{ /* XfwfCommon_class part */
XtInherit_compute_inside,
XtInherit_total_frame_width,
XtInherit_highlight_border,
XtInherit_unhighlight_border,
XtInherit_would_accept_focus,
XtInherit_traverse,
XtInherit_lighter_color,
XtInherit_darker_color,
/* traversal_trans */  NULL ,
},
{ /* XfwfFrame_class part */
 /* dummy */  0
},
{ /* XfwfBoard_class part */
XtInherit_set_abs_location,
},
{ /* XfwfIcon_class part */
 /* dummy */  0
},
};
WidgetClass xfwfIconWidgetClass = (WidgetClass) &xfwfIconClassRec;
/*ARGSUSED*/
#line 161 "Icon.w"
static void activate(self,event,params,num_params)Widget self;XEvent*event;String*params;Cardinal*num_params;
{
    XtCallCallbackList(self, ((XfwfIconWidget)self)->xfwfIcon.activate, event);
}

static void _resolve_inheritance(class)
WidgetClass class;
{
  XfwfIconWidgetClass c = (XfwfIconWidgetClass) class;
  XfwfIconWidgetClass super;
  static CompositeClassExtensionRec extension_rec = {
    NULL, NULLQUARK, XtCompositeExtensionVersion,
    sizeof(CompositeClassExtensionRec), True};
  CompositeClassExtensionRec *ext;
  ext = (XtPointer)XtMalloc(sizeof(*ext));
  *ext = extension_rec;
  ext->next_extension = c->composite_class.extension;
  c->composite_class.extension = ext;
  if (class == xfwfIconWidgetClass) return;
  super = (XfwfIconWidgetClass)class->core_class.superclass;
}
#line 57 "Icon.w"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 57 "Icon.w"
static void initialize(Widget  request,Widget self,ArgList  args,Cardinal * num_args)
#else
#line 57 "Icon.w"
static void initialize(request,self,args,num_args)Widget  request;Widget self;ArgList  args;Cardinal * num_args;
#endif
#line 58 "Icon.w"
{
    Dimension dummy1, dummy2;
    Position x, y;

    ((XfwfIconWidget)self)->xfwfIcon.image_gc = NULL;
    create_image_gc(self);
    if (((XfwfIconWidget)self)->xfwfIcon.image && ((XfwfIconWidget)self)->xfwfIcon.image->pixmap != None) {
	((XfwfIconWidgetClass)self->core.widget_class)->xfwfCommon_class.compute_inside(self, &x, &y, &dummy1, &dummy2);
	((XfwfIconWidget)self)->core.width = ((XfwfIconWidget)self)->xfwfIcon.image->attributes.width + 2*x;
	((XfwfIconWidget)self)->core.height = ((XfwfIconWidget)self)->xfwfIcon.image->attributes.height + 2*y;
	/* fprintf(stderr, "Icon.initialize: width=%d height=%d\n",
		$width, $height); */
    } else {
	((XfwfIconWidgetClass)self->core.widget_class)->xfwfCommon_class.compute_inside(self, &x, &y, &dummy1, &dummy2);
	((XfwfIconWidget)self)->core.width = 10 + 2*x;
	((XfwfIconWidget)self)->core.height = 10 + 2*y;
	/* fprintf(stderr, "Icon.initialize: width=%d height=%d (no icon)\n",
		$width, $height); */
    }
}
#line 85 "Icon.w"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 85 "Icon.w"
static void expose(Widget self,XEvent * event,Region  region)
#else
#line 85 "Icon.w"
static void expose(self,event,region)Widget self;XEvent * event;Region  region;
#endif
#line 86 "Icon.w"
{
    Dimension wd, ht;
    Position x, y;

    if (! XtIsRealized(self)) return;
    if (((XfwfIconWidget)self)->xfwfIcon.image && ((XfwfIconWidget)self)->xfwfIcon.image->pixmap != None) {
	((XfwfIconWidgetClass)self->core.widget_class)->xfwfCommon_class.compute_inside(self, &x, &y, &wd, &ht);
	XFillRectangle(XtDisplay(self), XtWindow(self), ((XfwfIconWidget)self)->xfwfIcon.image_gc, x, y, wd, ht);
    }
    xfwfBoardClassRec.core_class.expose(self, event, region);
}
#line 101 "Icon.w"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 101 "Icon.w"
static Boolean  set_values(Widget  old,Widget  request,Widget self,ArgList  args,Cardinal * num_args)
#else
#line 101 "Icon.w"
static Boolean  set_values(old,request,self,args,num_args)Widget  old;Widget  request;Widget self;ArgList  args;Cardinal * num_args;
#endif
#line 102 "Icon.w"
{
    Dimension dummy1, dummy2;
    Position x, y;
    Boolean need_redraw = False;

    if (((XfwfIconWidget)old)->xfwfFrame.frameWidth != ((XfwfIconWidget)self)->xfwfFrame.frameWidth
	|| ((XfwfIconWidget)old)->xfwfFrame.outerOffset != ((XfwfIconWidget)self)->xfwfFrame.outerOffset
	|| ((XfwfIconWidget)old)->xfwfIcon.image != ((XfwfIconWidget)self)->xfwfIcon.image) {
	create_image_gc(self);
	need_redraw = True;
    }
    if (((XfwfIconWidget)old)->xfwfIcon.image != ((XfwfIconWidget)self)->xfwfIcon.image) {
	if (! ((XfwfIconWidget)self)->xfwfIcon.image) {				/* Remove shape mask */
	    XShapeCombineMask(XtDisplay(self), XtWindow(self), ShapeBounding,
			      0, 0, None, ShapeSet);
	} else {				/* New size and shape */
	    ((XfwfIconWidgetClass)self->core.widget_class)->xfwfCommon_class.compute_inside(self, &x, &y, &dummy1, &dummy2);
	    if (((XfwfIconWidget)self)->xfwfIcon.image->pixmap != None
		&& (((XfwfIconWidget)self)->xfwfIcon.image->attributes.valuemask & XpmSize) != 0)
		((XfwfIconWidgetClass)self->core.widget_class)->xfwfBoard_class.set_abs_location(self, CWWidth | CWHeight, 0, 0,
				  ((XfwfIconWidget)self)->xfwfIcon.image->attributes.width + 2*x,
				  ((XfwfIconWidget)self)->xfwfIcon.image->attributes.height + 2*y);
	    if (XtIsRealized(self))
		XShapeCombineMask(XtDisplay(self), XtWindow(self), ShapeBounding,
				  x, y, ((XfwfIconWidget)self)->xfwfIcon.image->mask, ShapeSet);
	}
	need_redraw = True;
    }
    return need_redraw;
}
#line 136 "Icon.w"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 136 "Icon.w"
static void realize(Widget self,XtValueMask * mask,XSetWindowAttributes * attributes)
#else
#line 136 "Icon.w"
static void realize(self,mask,attributes)Widget self;XtValueMask * mask;XSetWindowAttributes * attributes;
#endif
#line 137 "Icon.w"
{
    Dimension wd, ht;
    Position x, y;

    xfwfBoardClassRec.core_class.realize(self, mask, attributes);
    ((XfwfIconWidgetClass)self->core.widget_class)->xfwfCommon_class.compute_inside(self, &x, &y, &wd, &ht);
    XShapeCombineMask(XtDisplay(self), XtWindow(self), ShapeBounding, x, y,
		      ((XfwfIconWidget)self)->xfwfIcon.image ? ((XfwfIconWidget)self)->xfwfIcon.image->mask : None, ShapeSet);
}
#line 43 "Icon.w"
